<!doctype html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <title>Form Advanced | Skote - Responsive Bootstrap 4 Admin Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Premium Multipurpose Admin & Dashboard Template" name="description">
    <meta content="Themesbrand" name="author">
    <!-- App favicon -->
    <link rel="shortcut icon" href="assets\images\favicon.ico">
    <!-- Select2 css-->
    <link href="\assets\libs\select2\css\select2.min.css" rel="stylesheet" type="text/css">

    <!-- Bootstrap Css -->
    <link href="\assets\css\bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css">
    <!-- App Css-->
    <link href="\assets\css\app.min.css" id="app-style" rel="stylesheet" type="text/css">

</head>

<body data-sidebar="dark">

    <div class="row mt-5 ml-5">
        <div class="col-lg-6">
            <div class="form-group">
                <label class="control-label">Single Select</label>
                <select class="form-control select2" id="productSelect2">
                </select>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
<!--    <script src="\assets\libs\jquery\jquery.min.js"></script>-->
    <th:block th:replace="/layout/script/javascript :: javascript"/>

    <script src="\assets\libs\select2\js\select2.min.js"></script>

    <!-- form advanced init -->
    <script src="\assets\js\pages\form-advanced.init.js"></script>

<!--    <script src="\assets\js\app.js"></script>-->
    <th:block th:replace="/layout/script/app-js :: app-js"/>


    <script>
        let page = {
            url: {
                getAllProduct: App.BASER_URL + "/products",
            },
            loadData: {},
            commands: {},
            dialogs: {
                elements: {},
                commands: {},
                alertDanger: {}
            },
        };

        // page.elements.productSelect2 = $('#productSelect2')

        let products = [];
        let productId;

        page.commands.getAllProduct = () => {
            $.ajax({
                headers: {
                    "accept": "application/json",
                    "content-type": "application/json"
                },
                type: "GET",
                url: page.url.getAllProduct,
            })
            .done((data) => {
                console.log(data);
                products = data;

                let str = '';

                $.each(products, (i, item) => {
                    str = App.renderProductsSelect2(item);

                    $('#productSelect2').append(str);
                })
            })
            .fail((jqxHR) => {
                console.log(jqxHR);
            })
        }

        page.commands.initializeControlEvent = () => {
            $('#productSelect2').on('change', () => {
                productId = $('#productSelect2').val();
                $(`#productSelect2 option[value=${productId}]`).remove();
            });
        }

        $(() => {
            page.commands.getAllProduct();

            page.commands.initializeControlEvent();

        })


    </script>
</body>
</html>
